<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alice</title>
</head>

<body>
    <button id="播放按钮">播放Alice</button>

    <script>
        const 音符 = [
            { 名称: '5.', 频率: 164.45, 时长: 500 },
            { 名称: '6.', 频率: 220, 时长: 500 },

            { 名称: '0', 频率: 0, 时长: 500 },
            { 名称: '1', 频率: 261.63, 时长: 500 },
            { 名称: '2', 频率: 293.66, 时长: 500 },
            { 名称: '3', 频率: 329.63, 时长: 500 },
            { 名称: '4', 频率: 349.23, 时长: 500 },
            { 名称: '5', 频率: 392.00, 时长: 500 },
            { 名称: '6', 频率: 440.00, 时长: 500 },
            { 名称: '7', 频率: 493.88, 时长: 500 },

            { 名称: '1+', 频率: 500.255, 时长: 500 },
            { 名称: '2+', 频率: 540.48, 时长: 500 },
            { 名称: '3+', 频率: 580.61, 时长: 500 },
            { 名称: '6+', 频率: 600.33, 时长: 500 },
        ];
        // Web Audio API这个东西可以让网页发出声音
        let 音频上下文;
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        音频上下文 = new AudioContext();
        // 播放单个音符的函数，到达时长后停止。
        function 播放音符(音符对象) {
            return new Promise((解决) => {
                const 声音源 = 音频上下文.createOscillator();
                声音源.type = 'sine';
                声音源.frequency.value = 音符对象.频率;
                声音源.connect(音频上下文.destination);
                声音源.start();
                setTimeout(() => {
                    声音源.stop();
                    解决();
                }, 音符对象.时长);
            });
        }
        // 播放音符序列的函数
        async function 播放音符序列(音符名称数组) {
            for (const 名称 of 音符名称数组) {
                const 音符参数 = 音符.find(n => n.名称 === 名称);
                if (音符) {
                    await 播放音符(音符参数);
                } else {
                    console.error(`未找到名称为 '${名称}' 的音符。`);
                }
            }
        }
        document.getElementById('播放按钮').addEventListener('click', () => {
            const 音符名称数组 = [
                '1', '3', '5', '0', '6', '1', '1', '0', '6.', '1', '3', '3', '0', '2', '1', '1', '0',
                '1', '3', '5', '0', '6', '1', '1', '0', '6.', '1', '3', '0', '2', '4', '3', '0',
                '1', '3', '5', '0', '6', '1', '1', '0', '6.', '1', '3', '0', '2', '1', '1', '0',
                // '1', '3', '5', '0', '3+', '6+', '6+', '1+', '0', '3+', '2+', '1+', '1+', '0',
                '1', '1', '3', '5', '0', '6', '1', '1', '0', '6.', '5.', '1', '3', '4', '0', '2', '1', '1', '0',
                '1', '1', '3', '5', '0', '6', '1', '1', '0', '6.', '6.', '1', '0', '3', '4', '2', '1', '1', '0',
                '1', '3', '5', '0', '6', '1', '1', '0', '6.', '1', '3', '0', '2', '4', '3', '0',
                // '1', '3', '5', '0', '3+', '6+', '6+', '1+', '0', '3+', '2+', '1+', '1+', '0',
                '3', '2', '1', '1', '1', '5', '5', '0', '3', '3', '2', '2', '0', '1', '2', '3', '0',
                '3', '2', '1', '1', '1', '5', '5', '0', '3', '0', '2', '4', '3', '1', '0',
                '4', '3', '1', '1', '1', '5', '5', '0', '3', '3', '2', '0', '1', '2', '3', '0',
            ];
            播放音符序列(音符名称数组).then(() => {
                console.log('所有音符播放完毕');
            }).catch((错误) => {
                console.error('播放音符时出错：', 错误);
            });
        });  
    </script>
</body>

</html>